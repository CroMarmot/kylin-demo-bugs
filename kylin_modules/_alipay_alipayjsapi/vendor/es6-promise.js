!function(t){"use strict";var e=t.Promise;if(!e||"[object Promise]"!==Object.prototype.toString.call(e.resolve())||e.cast){var n,r,o,i,s,u,c,a=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},f=0,l=function(t,e){d[f]=t,d[f+1]=e,2===(f+=2)&&(r?r(q):o())},h="undefined"!=typeof window?window:void 0,_=h||{},p=_.MutationObserver||_.WebKitMutationObserver,v="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),y="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,d=new Array(1e3);v?o=function(){process.nextTick(q)}:p?(s=0,u=new p(q),c=document.createTextNode(""),u.observe(c,{characterData:!0}),o=function(){c.data=s=++s%2}):y?((i=new MessageChannel).port1.onmessage=q,o=function(){i.port2.postMessage(0)}):o=void 0===h&&"function"==typeof require?function(){try{var t=require("vertx");return n=t.runOnLoop||t.runOnContext,function(){n(q)}}catch(t){return k()}}():k();var m=function(t,e){var n=this,r=new this.constructor(D);void 0===r[b]&&I(r);var o=n._state;if(o){var i=arguments[o-1];l(function(){H(o,r,i,n._result)})}else z(n,r,t,e);return r},w=function(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(D);return L(e,t),e},b=Math.random().toString(36).substring(16),g=void 0,A=1,S=2,j=new G,E=new G,T=0,M=function(t){return new x(this,t).promise},C=function(t){var e=this;return a(t)?new e(function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}):new e(function(t,e){e(new TypeError("You must pass an array to race."))})},O=function(t){var e=new this(D);return W(e,t),e},P=J;J.all=M,J.race=C,J.resolve=w,J.reject=O,J._setScheduler=function(t){r=t},J._setAsap=function(t){l=t},J._asap=l,J.prototype={constructor:J,then:m,catch:function(t){return this.then(null,t)}};var x=Q;Q.prototype._enumerate=function(){for(var t=this.length,e=this._input,n=0;this._state===g&&n<t;n++)this._eachEntry(e[n],n)},Q.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===w){var o=F(t);if(o===m&&t._state!==g)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===P){var i=new n(D);K(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){e(t)}),e)}else this._willSettleAt(r(t),e)},Q.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===g&&(this._remaining--,t===S?W(r,n):this._result[e]=n),0===this._remaining&&U(r,this._result)},Q.prototype._willSettleAt=function(t,e){var n=this;z(t,void 0,function(t){n._settledAt(A,e,t)},function(t){n._settledAt(S,e,t)})},t.Promise=P}function Y(t){return"function"==typeof t}function k(){return function(){setTimeout(q,1)}}function q(){for(var t=0;t<f;t+=2){(0,d[t])(d[t+1]),d[t]=void 0,d[t+1]=void 0}f=0}function D(){}function F(t){try{return t.then}catch(t){return j.error=t,j}}function K(t,e,n){e.constructor===t.constructor&&n===m&&constructor.resolve===w?function(t,e){e._state===A?U(t,e._result):e._state===S?W(t,e._result):z(e,void 0,function(e){L(t,e)},function(e){W(t,e)})}(t,e):n===j?W(t,j.error):void 0===n?U(t,e):Y(n)?function(t,e,n){l(function(t){var r=!1,o=function(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}(n,e,function(n){r||(r=!0,e!==n?L(t,n):U(t,n))},function(e){r||(r=!0,W(t,e))},t._label);!r&&o&&(r=!0,W(t,o))},t)}(t,e,n):U(t,e)}function L(t,e){var n;t===e?W(t,new TypeError("You cannot resolve a promise with itself")):"function"==typeof(n=e)||"object"==typeof n&&null!==n?K(t,e,F(e)):U(t,e)}function N(t){t._onerror&&t._onerror(t._result),B(t)}function U(t,e){t._state===g&&(t._result=e,t._state=A,0!==t._subscribers.length&&l(B,t))}function W(t,e){t._state===g&&(t._state=S,t._result=e,l(N,t))}function z(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+A]=n,o[i+S]=r,0===i&&t._state&&l(B,t)}function B(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r,o,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?H(n,r,o,i):o(i);t._subscribers.length=0}}function G(){this.error=null}function H(t,e,n,r){var o,i,s,u,c=Y(n);if(c){if((o=function(t,e){try{return t(e)}catch(t){return E.error=t,E}}(n,r))===E?(u=!0,i=o.error,o=null):s=!0,e===o)return void W(e,new TypeError("A promises callback cannot return that same promise."))}else o=r,s=!0;e._state!==g||(c&&s?L(e,o):u?W(e,i):t===A?U(e,o):t===S&&W(e,o))}function I(t){t[b]=T++,t._state=void 0,t._result=void 0,t._subscribers=[]}function J(t){this[b]=T++,this._result=this._state=void 0,this._subscribers=[],D!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof J?function(t,e){try{e(function(e){L(t,e)},function(e){W(t,e)})}catch(e){W(t,e)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}function Q(t,e){this._instanceConstructor=t,this.promise=new t(D),this.promise[b]||I(this.promise),a(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?U(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&U(this.promise,this._result))):W(this.promise,new Error("Array Methods must be provided an Array"))}}(this);