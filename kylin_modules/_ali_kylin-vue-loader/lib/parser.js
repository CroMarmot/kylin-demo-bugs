var compiler=require("./compiler-normalizer"),cache=require("lru-cache")(100),hash=require("hash-sum"),SourceMapGenerator=require("source-map").SourceMapGenerator,splitRE=/\r?\n/g,emptyRE=/^(?:\/\/)?\s*$/;function generateSourceMap(e,r,t){var a=new SourceMapGenerator;return a.setSourceContent(e,r),t.split(splitRE).forEach((r,t)=>{emptyRE.test(r)||a.addMapping({source:e,original:{line:t+1,column:0},generated:{line:t+1,column:0}})}),a.toJSON()}module.exports=function(e,r,t){var a=hash(r+e),c=r+"?"+a,o=cache.get(a);return o||(o=compiler.parseComponent(e,{pad:!0}),t&&(o.script&&!o.script.src&&(o.script.map=generateSourceMap(c,e,o.script.content)),o.styles&&o.styles.forEach(r=>{r.src||(r.map=generateSourceMap(c,e,r.content))})),cache.set(a,o),o)};