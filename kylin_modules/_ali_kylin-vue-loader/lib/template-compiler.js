var compiler=require("./compiler-normalizer"),transpile=require("vue-template-es2015-compiler"),loaderUtils=require("loader-utils"),beautify=require("js-beautify").js_beautify,normalize=require("./normalize"),hotReloadAPIPath=normalize.dep("vue-hot-reload-api"),defaultTransformToRequire={img:"src",image:"xlink:href"},transformToRequire=defaultTransformToRequire,defaultCompileOptions={modules:[{postTransformNode(e){for(var r in transformToRequire)if(e.tag===r&&e.attrs){var t=transformToRequire[r];"string"==typeof t?e.attrs.some(e=>rewrite(e,t)):Array.isArray(t)&&t.forEach(r=>e.attrs.some(e=>rewrite(e,r)))}}}]};function rewrite(e,r){if(e.name===r){var t=e.value;if(!('"'===t.charAt(0)&&'"'===t.charAt(t.length-1)))return;var i=t.charAt(1);return"."!==i&&"~"!==i||("~"===i&&(t='"'+t.slice(2)),e.value=`require(${t})`),!0}}function toFunction(e){return"function (){"+beautify(e,{indent_size:2})+"}"}function pad(e){return e.split(/\r?\n/).map(e=>`  ${e}`).join("\n")}module.exports=function(e){this.cacheable();var r="node"===this.target,t=this.minimize||"production"===process.env.NODE_ENV,i=loaderUtils.getOptions(this)||{};i.transformToRequire&&(transformToRequire=Object.assign({},defaultTransformToRequire,i.transformToRequire));var o,n=compiler.compile(e,Object.assign({preserveWhitespace:i.preserveWhitespace},defaultCompileOptions));if(n.tips&&n.tips.length&&n.tips.forEach(e=>{this.emitWarning(e)}),n.errors&&n.errors.length)this.emitError(`\n  Error compiling template:\n${pad(e)}\n`+n.errors.map(e=>`  - ${e}`).join("\n")+"\n"),o="module.exports={render:function(){},staticRenderFns:[]}";else{var a=i.buble;o=transpile("module.exports={render:"+toFunction(n.render)+",staticRenderFns: ["+n.staticRenderFns.map(toFunction).join(",")+"]}",a),t||a&&a.transforms&&!1===a.transforms.stripWith||(o+="\nmodule.exports.render._withStripped = true")}return r||t||(o+="\nif (module.hot) {\n  module.hot.accept()\n  if (module.hot.data) {\n     require("+JSON.stringify(hotReloadAPIPath)+').rerender("'+i.id+'", module.exports)\n  }\n}'),o};