"use strict";exports.__esModule=!0,exports.definitions=void 0,exports.default=function(e){var r=e.messages,t=e.template,i=e.types;function n(e){return(0,_definitions2.default)(e&&e.nebulaTarget)}function o(e){return e.moduleName||"babel-runtime"}function s(e,r){return Object.prototype.hasOwnProperty.call(e,r)}var a=["interopRequireWildcard","interopRequireDefault"];return{pre:function(e){var r=o(this.opts);!1!==this.opts.helpers&&e.set("helperGenerator",function(t){if(a.indexOf(t)<0)return e.addImport(r+"/helpers/"+t,"default",t)}),this.setDynamic("regeneratorIdentifier",function(){return e.addImport(r+"/regenerator","default","regeneratorRuntime")})},visitor:{ForOfStatement:(0,_forOf.factory)({messages:r,template:t,types:i}),Program:{exit:function(e,r){!1!==r.opts.requeue&&(this.requeued||(e.requeue(),this.requeued=!0)),r.opts.ensureExitPromise&&e.traverse(_promise.exitPromiseVisitor,r)}},ReferencedIdentifier:function(e,r){var t=e.node,a=e.parent,p=e.scope;if("regeneratorRuntime"!==t.name||!1===r.opts.regenerator){if(!1!==r.opts.polyfill&&!i.isMemberExpression(a)&&s(n(r.opts).builtins,t.name)&&!p.getBindingIdentifier(t.name)){var l=o(r.opts);r.opts.preferExternalPromise&&"Promise"===t.name?e.replaceWith((0,_promise.addPromiseHelper)({file:e.hub.file,promise:l+"/core-js/"+n(r.opts).builtins[t.name]})):e.replaceWith(r.addImport(l+"/core-js/"+n(r.opts).builtins[t.name],"default",t.name))}}else e.replaceWith(r.get("regeneratorIdentifier"))},CallExpression:function(e,r){if(!1!==r.opts.polyfill&&!e.node.arguments.length){var t=e.node.callee;if(i.isMemberExpression(t)&&t.computed&&e.get("callee.property").matchesPattern("Symbol.iterator")){var n=o(r.opts);e.replaceWith(i.callExpression(r.addImport(n+"/core-js/get-iterator","default","getIterator"),[t.object]))}}},BinaryExpression:function(e,r){if(!1!==r.opts.polyfill&&"in"===e.node.operator&&e.get("left").matchesPattern("Symbol.iterator")){var t=o(r.opts);e.replaceWith(i.callExpression(r.addImport(t+"/core-js/is-iterable","default","isIterable"),[e.node.right]))}},MemberExpression:{enter:function(e,r){if(!1!==r.opts.polyfill&&e.isReferenced()){var t=e.node,a=t.object,p=t.property;if(i.isReferenced(a,t)&&!t.computed&&s(n(r.opts).methods,a.name)){var l=n(r.opts).methods[a.name];if(s(l,p.name)&&!e.scope.getBindingIdentifier(a.name)){if("Object"===a.name&&"defineProperty"===p.name&&e.parentPath.isCallExpression()){var m=e.parentPath.node;if(3===m.arguments.length&&i.isLiteral(m.arguments[1]))return}var u=o(r.opts);if(_runtime2.default[l[p.name]]&&r.opts.loosePolyfill){var f=require.resolve(__dirname+"/runtime/"+l[p.name]);e.replaceWith(r.addImport(f,"default",a.name+"$"+p.name))}else e.replaceWith(r.addImport(u+"/core-js/"+l[p.name],"default",a.name+"$"+p.name))}}}},exit:function(e,r){if(!1!==r.opts.polyfill&&e.isReferenced()){var t=e.node,a=t.object;if(s(n(r.opts).builtins,a.name)&&!e.scope.getBindingIdentifier(a.name)){var p=o(r.opts);r.opts.preferExternalPromise&&"Promise"===a.name?e.replaceWith(i.memberExpression((0,_promise.addPromiseHelper)({file:e.hub.file,promise:p+"/core-js/"+n(r.opts).builtins[a.name]}),t.property,t.computed)):e.replaceWith(i.memberExpression(r.addImport(p+"/core-js/"+n(r.opts).builtins[a.name],"default",a.name),t.property,t.computed))}}}}}}};var _definitions=require("./definitions"),_definitions2=_interopRequireDefault(_definitions),_forOf=require("./for-of"),_promise=require("./promise"),_runtime=require("./runtime"),_runtime2=_interopRequireDefault(_runtime);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}exports.definitions=_definitions2.default;