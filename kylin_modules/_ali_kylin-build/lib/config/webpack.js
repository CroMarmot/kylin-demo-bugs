"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.webpackConfigFactory=webpackConfigFactory;var _index=require("../utils/index"),_options=require("./options"),_babel=require("./babel"),_index2=require("../build/utils/index"),_core=require("cssnano/dist/lib/core"),_core2=_interopRequireDefault(_core);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function webpackConfigFactory(e,t){(t=(0,_options.userOption)(t)).options;return supportVueLoader(e),e.babel?e.babel=(0,_babel.babelConfigFactory)(e.babel,t):e.babel=(0,_babel.babelConfig)(t),supportVueConfig(e,t),e}function getExtractCssEnable(e){let t,r=!1;try{t=require("extract-text-webpack-plugin")}catch(e){return!1}return e.plugins.forEach(function(e,o){e instanceof t&&(r=!0)}),r}function supportVueConfig(e,t){const r=t.env,o=t.options;if(!e.vue||t.forceVueConfig){let i=getExtractCssEnable(e);e.vue={preserveWhitespace:o.preserveWhitespace,esModule:!0,loaders:(0,_index2.cssLoaders)({sourceMap:!1,extract:"boolean"==typeof t.vueStyleExtract?t.vueStyleExtract:i,publicPath:t.vueStylePublichPath}),postcss:e.postcss||[require("autoprefixer")({browsers:["Chrome >= 30","iOS >= 7","Android >= 2","ChromeAndroid >= 2","last 10 UCAndroid versions"]}),"production"===r?_core2.default:null].filter(Boolean)},t.vueStyleExtract&&!i&&_index.hint.error("[Style]","need plugin ExtractTextWebpackPlugin if params.vueStyleExtract=true")}}function supportVueLoader(e){e.module.loaders.forEach(function(t,r){let o=!1;"object"==typeof t.test?o=o||t.test.test("a.vue"):"function"==typeof t.test&&(o=o||t.test("a.vue")),o&&e.module.loaders.splice(r,1)}),e.module.loaders.push({test:/\.vue$/,loader:require.resolve("@ali/kylin-vue-loader")}),e.resolve.extensions.filter(e=>/^\.vue$/i.test(e)).length||e.resolve.extensions.push(".vue")}