"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=generateBuildImpl;var _path=require("path"),_path2=_interopRequireDefault(_path),_fs=require("fs"),_fs2=_interopRequireDefault(_fs);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function generateBuildImpl(e,t){return function(_){var r=t||require("webpack"),i=_path2.default.dirname(e),a=_path2.default.resolve(i,"./jsapi/"),n=_path2.default.resolve(i,"./rpc/"),s={jsapi:!1,rpc:!1};try{s.jsapi=_fs2.default.lstatSync(a).isDirectory()}catch(e){}try{s.rpc=_fs2.default.lstatSync(n).isDirectory()}catch(e){}return _.plugins.unshift(new r.DefinePlugin({__KYLIN_PLUGIN_LUNA_MOCK_CONFIG__:JSON.stringify(e),__KYLIN_PLUGIN_LUNA_MOCK_WORKING_DIR__:JSON.stringify(i),__KYLIN_PLUGIN_LUNA_MOCK_CONTEXT_JSAPI__:JSON.stringify(s.jsapi?"./context/jsapi.js":"./context/noop.js"),__KYLIN_PLUGIN_LUNA_MOCK_CONTEXT_RPC__:JSON.stringify(s.rpc?"./context/rpc.js":"./context/noop.js")})),_}}